/*! third party licenses: dist/vendor.LICENSE.txt */
import{aH as g,c6 as _,c7 as x,c8 as D,c9 as I,aW as S,bT as h,a_ as m,aM as w,F as A,bg as p,bE as y,bS as F,aJ as k,bb as C}from"../core-common.mjs";import{S as E}from"./sortable.esm-CKUZvLoo.mjs";import{b as L,c as U,n as b}from"./icons-BxSPavMS.mjs";const Y=()=>{[...document.head.querySelectorAll("link.theme")].forEach(e=>{const a=new URL(e.href);a.searchParams.set("v",Date.now());const o=e.cloneNode();o.href=a.toString(),o.onload=()=>e.remove(),document.head.append(o)})};g.util.warn;function N(e,a,o={}){let s;const{document:r=I,...u}=o,v={onUpdate:t=>{O(a,t.oldIndex,t.newIndex)}},c=()=>{const t=typeof e=="string"?r==null?void 0:r.querySelector(e):D(e);!t||s!==void 0||(s=new E(t,{...v,...u}))},d=()=>{s==null||s.destroy(),s=void 0},f=(t,n)=>{if(n!==void 0)s==null||s.option(t,n);else return s==null?void 0:s.option(t)};return _(c),x(d),{stop:d,start:c,option:f}}function O(e,a,o){const s=S(e),r=s?[...h(e)]:h(e);if(o>=0&&o<r.length){const u=r.splice(a,1)[0];m(()=>{r.splice(o,0,u),s&&(e.value=r)})}}const B=w({name:"AppOrderSelectorElement",components:{IconArrowDown:L,IconArrowUp:U,NcButton:A},props:{ariaDescribedby:{type:String,default:null},ariaDetails:{type:String,default:null},app:{type:Object,required:!0},isFirst:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:{"move:up":()=>!0,"move:down":()=>!0,"update:focus":()=>!0},setup(e,{emit:a}){const o=p(),s=p();let r=0;return{buttonUp:o,buttonDown:s,moveUp:()=>{a("move:up"),r=1},moveDown:()=>{a("move:down"),r=-1},keepFocus:()=>{r!==0&&((r===1||e.isLast)&&!e.isFirst?m(()=>o.value.$el.focus()):m(()=>s.value.$el.focus())),r=0},t:y}}});var M=function(){var o;var e=this,a=e._self._c;return e._self._setupProxy,a("li",{class:{"order-selector-element":!0,"order-selector-element--disabled":e.app.default},attrs:{"data-cy-app-order-element":e.app.id},on:{focusin:function(s){return e.$emit("update:focus")}}},[a("svg",{attrs:{width:"20",height:"20",viewBox:"0 0 20 20",role:"presentation"}},[a("image",{staticClass:"order-selector-element__icon",attrs:{preserveAspectRatio:"xMinYMin meet",x:"0",y:"0",width:"20",height:"20","xlink:href":e.app.icon}})]),a("div",{staticClass:"order-selector-element__label"},[e._v(" "+e._s((o=e.app.label)!=null?o:e.app.id)+" ")]),a("div",{staticClass:"order-selector-element__actions"},[a("NcButton",{directives:[{name:"show",rawName:"v-show",value:!e.isFirst&&!e.app.default,expression:"!isFirst && !app.default"}],ref:"buttonUp",attrs:{"aria-label":e.t("settings","Move up"),"aria-describedby":e.ariaDescribedby,"aria-details":e.ariaDetails,"data-cy-app-order-button":"up",type:"tertiary-no-background"},on:{click:e.moveUp},scopedSlots:e._u([{key:"icon",fn:function(){return[a("IconArrowUp",{attrs:{size:20}})]},proxy:!0}])}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isFirst||!!e.app.default,expression:"isFirst || !!app.default"}],staticClass:"order-selector-element__placeholder",attrs:{"aria-hidden":"true"}}),a("NcButton",{directives:[{name:"show",rawName:"v-show",value:!e.isLast&&!e.app.default,expression:"!isLast && !app.default"}],ref:"buttonDown",attrs:{"aria-label":e.t("settings","Move down"),"aria-describedby":e.ariaDescribedby,"aria-details":e.ariaDetails,"data-cy-app-order-button":"down",type:"tertiary-no-background"},on:{click:e.moveDown},scopedSlots:e._u([{key:"icon",fn:function(){return[a("IconArrowDown",{attrs:{size:20}})]},proxy:!0}])}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isLast||!!e.app.default,expression:"isLast || !!app.default"}],staticClass:"order-selector-element__placeholder",attrs:{"aria-hidden":"true"}})],1)])},$=[],q=b(B,M,$,!1,null,"6af58cd7",null,null);const P=q.exports,z=w({name:"AppOrderSelector",components:{AppOrderSelectorElement:P,Fragment:F},props:{ariaDetails:{type:String,default:null},value:{type:Array,required:!0}},emits:{"update:value":e=>Array.isArray(e)},setup(e,{emit:a}){const o=p(null),s=k({get:()=>e.value,set:t=>{const n=[...t].sort((l,i)=>(i.default?1:0)-(l.default?1:0)||t.indexOf(l)-t.indexOf(i));n.some(({id:l},i)=>l!==e.value[i].id)?a("update:value",n):r.value+=1}}),r=p(0);N(o,s,{filter:".order-selector-element--disabled"});const u=p([]);C(()=>{u.value.forEach(t=>t.keepFocus())});const v=t=>{var n;const l=t>1?e.value.slice(0,t-1):[];if((n=e.value[t-1])!=null&&n.default)return;const i=[e.value[t-1]];t<e.value.length-1&&i.push(...e.value.slice(t+1)),a("update:value",[...l,e.value[t],...i])},c=t=>{const n=t>0?e.value.slice(0,t):[];n.push(e.value[t+1]);const l=t<e.value.length-2?e.value.slice(t+2):[];a("update:value",[...n,e.value[t],...l])},d=p(""),f="sorting-status-info-".concat((Math.random()+1).toString(36).substring(7));return{appList:s,listElement:o,moveDown:c,moveUp:v,statusInfoId:f,statusInfo:d,updateStatusInfo:t=>{d.value=y("theming","Current selected app: {app}, position {position} of {total}",{app:e.value[t].label,position:t+1,total:e.value.length})},renderCount:r,selectorElements:u}}});var R=function(){var e=this,a=e._self._c;return e._self._setupProxy,a("Fragment",[a("div",{staticClass:"hidden-visually",attrs:{id:e.statusInfoId,"aria-live":"polite",role:"status"}},[e._v(" "+e._s(e.statusInfo)+" ")]),a("ol",{ref:"listElement",staticClass:"order-selector",attrs:{"data-cy-app-order":""}},e._l(e.appList,function(o,s){return a("AppOrderSelectorElement",e._g({key:"".concat(o.id).concat(e.renderCount),ref:"selectorElements",refInFor:!0,attrs:{app:o,"aria-details":e.ariaDetails,"aria-describedby":e.statusInfoId,"is-first":s===0||!!e.appList[s-1].default,"is-last":s===e.value.length-1}},o.default?{}:{"move:up":()=>e.moveUp(s),"move:down":()=>e.moveDown(s),"update:focus":()=>e.updateStatusInfo(s)}))}),1)])},j=[],H=b(z,R,j,!1,null,"0f93998d",null,null);const V=H.exports;export{V as A,Y as r};
