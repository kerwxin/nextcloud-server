{"version":3,"file":"sidebarAction-TbC0yk8r.mjs","sources":["../../apps/files/src/actions/sidebarAction.ts"],"sourcesContent":["/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { Permission, type Node, View, FileAction, FileType } from '@nextcloud/files'\nimport { translate as t } from '@nextcloud/l10n'\nimport InformationSvg from '@mdi/svg/svg/information-variant.svg?raw'\n\nimport logger from '../logger.js'\n\nexport const ACTION_DETAILS = 'details'\n\nexport const action = new FileAction({\n\tid: ACTION_DETAILS,\n\tdisplayName: () => t('files', 'Open details'),\n\ticonSvgInline: () => InformationSvg,\n\n\t// Sidebar currently supports user folder only, /files/USER\n\tenabled: (nodes: Node[]) => {\n\t\t// Only works on single node\n\t\tif (nodes.length !== 1) {\n\t\t\treturn false\n\t\t}\n\n\t\tif (!nodes[0]) {\n\t\t\treturn false\n\t\t}\n\n\t\t// Only work if the sidebar is available\n\t\tif (!window?.OCA?.Files?.Sidebar) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn (nodes[0].root?.startsWith('/files/') && nodes[0].permissions !== Permission.NONE) ?? false\n\t},\n\n\tasync exec(node: Node, view: View, dir: string) {\n\t\ttry {\n\t\t\t// TODO: migrate Sidebar to use a Node instead\n\t\t\tawait window.OCA.Files.Sidebar.open(node.path)\n\n\t\t\t// Silently update current fileid\n\t\t\twindow.OCP.Files.Router.goToRoute(\n\t\t\t\tnull,\n\t\t\t\t{ view: view.id, fileid: node.fileid },\n\t\t\t\t{ dir },\n\t\t\t\ttrue,\n\t\t\t)\n\n\t\t\treturn null\n\t\t} catch (error) {\n\t\t\tlogger.error('Error while opening sidebar', { error })\n\t\t\treturn false\n\t\t}\n\t},\n\n\torder: -50,\n})\n"],"names":["ACTION_DETAILS","action","FileAction","t","InformationSvg","nodes","_a","_b","_c","_d","Permission","node","view","dir","error","logger"],"mappings":";2KA2BO,MAAMA,EAAiB,UAEjBC,EAAS,IAAIC,EAAW,CACpC,GAAIF,EACJ,YAAa,IAAMG,EAAE,QAAS,cAAc,EAC5C,cAAe,IAAMC,EAGrB,QAAUC,GAAkB,CAnC7B,IAAAC,EAAAC,EAAAC,EAAAC,EA8CE,OATIJ,EAAM,SAAW,GAIjB,CAACA,EAAM,CAAC,GAKR,GAACE,GAAQD,EAAA,2BAAA,MAAR,KAAa,OAAAA,EAAA,QAAb,QAAoB,SACjB,IAGAG,IAAMD,EAAAH,EAAA,CAAC,EAAE,OAAT,KAAe,OAAAG,EAAA,WAAW,SAAc,IAAAH,EAAM,CAAC,EAAE,cAAgBK,EAAW,OAA5E,KAAqFD,EAAA,EAC9F,EAEA,MAAM,KAAKE,EAAYC,EAAYC,EAAa,CAC3C,GAAA,CAEH,aAAM,OAAO,IAAI,MAAM,QAAQ,KAAKF,EAAK,IAAI,EAGtC,OAAA,IAAI,MAAM,OAAO,UACvB,KACA,CAAE,KAAMC,EAAK,GAAI,OAAQD,EAAK,MAAO,EACrC,CAAE,IAAAE,CAAI,EACN,EAAA,EAGM,WACCC,EAAO,CACf,OAAAC,EAAO,MAAM,8BAA+B,CAAE,MAAAD,CAAO,CAAA,EAC9C,EACR,CACD,EAEA,MAAO,GACR,CAAC"}