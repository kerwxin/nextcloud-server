{"version":3,"file":"requesttoken-Db1tL2y3.mjs","sources":["../../core/src/OC/requesttoken.js"],"sourcesContent":["/**\n * @copyright 2019 Christoph Wurst <christoph@winzerhof-wurst.at>\n *\n * @author Christoph Wurst <christoph@winzerhof-wurst.at>\n * @author John Molakvo√¶ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { emit } from '@nextcloud/event-bus'\n\n/**\n * @private\n * @param {Document} global the document to read the initial value from\n * @param {Function} emit the function to invoke for every new token\n * @return {object}\n */\nexport const manageToken = (global, emit) => {\n\tlet token = global.getElementsByTagName('head')[0].getAttribute('data-requesttoken')\n\n\treturn {\n\t\tgetToken: () => token,\n\t\tsetToken: newToken => {\n\t\t\ttoken = newToken\n\n\t\t\temit('csrf-token-update', {\n\t\t\t\ttoken,\n\t\t\t})\n\t\t},\n\t}\n}\n\nconst manageFromDocument = manageToken(document, emit)\n\n/**\n * @return {string}\n */\nexport const getToken = manageFromDocument.getToken\n\n/**\n * @param {string} newToken new token\n */\nexport const setToken = manageFromDocument.setToken\n"],"names":["manageToken","global","emit","token","newToken","manageFromDocument","getToken","setToken"],"mappings":";wCA+BO,MAAMA,EAAc,CAACC,EAAQC,IAAS,CAC5C,IAAIC,EAAQF,EAAO,qBAAqB,MAAM,EAAE,CAAC,EAAE,aAAa,mBAAmB,EAEnF,MAAO,CACN,SAAU,IAAME,EAChB,SAAUC,GAAY,CACrBD,EAAQC,EAERF,EAAK,oBAAqB,CACzB,MAAAC,CACJ,CAAI,CACD,CACD,CACF,EAEME,EAAqBL,EAAY,SAAUE,CAAI,EAKxCI,EAAWD,EAAmB,SAK9BE,EAAWF,EAAmB"}